<?xml version="1.0" encoding="UTF-8"?>
<project name="dev-release" basedir=".">
  
  <fail unless="project.basedir" message="Property 'project.basedir' must be setted before loading build-bundle.xml"/>
  <fail unless="dev.path" message="Property 'dev.path' must be setted before loading build-bundle.xml"/>
      
  <property name="build-release.properties" value="${dev.path}/build/build-release.properties"/>
  <echo message="Load build-release.properties: ${dev.path}/build/build-release.properties" level="debug"/>
  <property file="${build-release.properties}"/>
  
  <!-- Import build-commons.xml -->
  <import file="build-commons.xml"/>
  
  <!-- Properties -->
  <property name="build.release.path" value="${build.path}/releases"/>
  
  <!-- Version -->
  <condition property="release.version" value="${env.TRAVIS_TAG}"><isset property="env.TRAVIS_TAG"/></condition>
  <condition property="release.version" value="${release.default.version}"><not><isset property="release.version"/></not></condition>
  
  <!-- Build number -->
  <condition property="release.buildnumber" value="${env.TRAVIS_BUILD_NUMBER}"><isset property="env.TRAVIS_BUILD_NUMBER"/></condition>
  <condition property="release.buildnumber" value="0"><not><isset property="release.buildnumber"/></not></condition>
  
  <!-- Full version -->
  <condition property="release.fullversion" value="${release.version}">
    <isset property="env.TRAVIS_TAG"/>
  </condition>
  <condition property="release.fullversion" value="${release.version}.${release.buildnumber}">
    <isset property="env.TRAVIS_BUILD_NUMBER"/>
  </condition>
  <condition property="release.fullversion" value="${release.version}-SNAPSHOT">
    <not>
      <isset property="env.TRAVIS_BUILD_NUMBER"/>
    </not>
  </condition>
  
</project>
